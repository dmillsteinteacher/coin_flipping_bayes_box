<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bayesian Coin Flipper: Bayes Boxes</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>

    <h1>ðŸ§  Bayesian Coin Flipper: Bayes Boxes</h1>
    <p class="description">Explore how new evidence updates our belief about the coin's bias.</p>

    <div class="tabs">
        <button class="tab-button active" onclick="showTab('config')">1. Setup Hypotheses</button>
        <button class="tab-button" onclick="showTab('update')" disabled id="update-tab">2. Update & Visualize</button>
        <button class="tab-button" onclick="showTab('history')" disabled id="history-tab">3. Distribution History</button>
    </div>

    <div id="app-container">

        <div id="config" class="tab-content active">
            <h2>Configuration: Define Hypotheses (The Boxes)</h2>
            <div id="config-controls">
                <label for="state-count">Number of States (Hypotheses):</label>
                <input type="number" id="state-count" value="5" min="2" max="10">
                <button onclick="initializeModel()">Generate Inputs</button>
            </div>
            
            <div id="hypothesis-inputs">
                </div>
            <button onclick="normalizePriors()">Normalize Priors</button>
            <button onclick="startSimulation()" id="start-button" disabled>Start Simulation</button>
            <p id="prior-sum-message"></p>
            <p class="note">Note: P-values must be between 0.01 and 0.99 (R7).</p>
        </div>

        <div id="update" class="tab-content">
            <h2>Coin Flip Trial</h2>
            <div id="data-input-area">
                <label for="flips-input">Total Flips (N):</label>
                <input type="number" id="flips-input" value="1" min="1" max="100">
                <label for="heads-input">Heads Observed (k):</label>
                <input type="number" id="heads-input" value="0" min="0">
                <button onclick="performUpdate()">See the Update!</button>
            </div>
            <p class="note" id="input-warning"></p>
            
            <div id="visualization-area">
                <div class="bayes-box-container">
                    <h3>Current Prior Distribution</h3>
                    <div id="prior-visualization" class="viz-area"></div>
                </div>
                <div class="bayes-box-container">
                    <h3>New Posterior Distribution</h3>
                    <div id="posterior-visualization" class="viz-area"></div>
                </div>
            </div>
            </div>

        <div id="history" class="tab-content">
            <h2>Distribution History: Evolution of Belief</h2>
            <p>Watch how the probability distribution evolves with each trial.</p>
            
            <div id="history-chart-container">
                <canvas id="history-chart"></canvas>
            </div>

            <div id="history-legend-area">
                </div>

            <h3>History Data Table</h3>
            <table id="history-table">
                <thead>
                    <tr>
                        <th>Trial</th>
                        <th>N</th>
                        <th>k</th>
                        </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

    </div>

    <script src="script.js"></script>
</body>
</html>